{% extends 'base.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% load humanize %}

{% block title %}Dishes{% endblock %}

{% block content %}

<div class="mt-3 mb-5 mx-3">

  <div class="row">

    {% if order_items %}
      <div class="col-8">
        <h1>Where do you want your order delivered?</h1>
        <form method="post">
          {% csrf_token %}
          {{ form|crispy }}
          <input type="submit" value="Proceed to payment" class="btn btn-primary">
        </form>
    {% else %}
      <div class="col">
        <p>You need to add some items to your cart before proceeding.</p>
        <p><a href="{% url 'webplatform:order_items_view' %}">Explore dishes</a></p>
    {% endif %}



    </div> <!-- col 1 -->

    {% if order_items %}

      <div class="col-4 sticky-top">
        <div class="sticky-top">
          <h5>
            Your order
            {% if messages and order_items %}
              {% for message in messages %}
                <span class="badge badge-light message">{{ message }}</span>
              {% endfor %}
            {% endif %}
          </h5>
          {% for order_item in order_items %}
            <div class="row py-2">
              <div class="col-7 text-left">
                {{ order_item.item.name }}
              </div>
              <div class="col-5 text-right">
                ${{ order_item.get_total_item_price|floatformat:2|intcomma }}
              </div>
            </div>
          {% endfor %}
          <div class="row border-top py-2">
            <div class="col text-right">
              ${{ order.get_total_order_price|floatformat:2|intcomma }}
            </div>
          </div>
        </div>
      </div>

    {% endif %}

  </div> <!-- row -->

</div> <!-- container -->

{% endblock %}
